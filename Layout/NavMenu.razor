<div class="top-row ps-3 navbar navbar-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="">
            <i class="fas fa-tasks me-2"></i>IbnelveApi
        </a>
        <button title="Navigation menu" class="navbar-toggler" @onclick="ToggleNavMenu">
            <span class="navbar-toggler-icon"></span>
        </button>
    </div>
</div>

<div class="@NavMenuCssClass nav-scrollable" @onclick="CollapseNavMenu">
    <nav class="flex-column">
        <!-- Dashboard -->
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="" Match="NavLinkMatch.All">
                <i class="fas fa-home me-2"></i> Dashboard
            </NavLink>
        </div>
        
        <!-- Pessoas 
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="pessoas">
                <i class="fas fa-users me-2"></i> Pessoas
            </NavLink>
        </div>-->
        
        <!-- Tarefas (Menu Expansível) -->
        <div class="nav-item px-3">
            <div class="nav-link menu-expandable @(tarefasMenuExpanded ? "expanded" : "")" @onclick="ToggleTarefasMenu" @onclick:stopPropagation="true">
                <div style="color: aliceblue" class="d-flex justify-content-between align-items-center">
                    <span>
                        <i class="fas fa-tasks me-2"></i> Tarefas
                    </span>
                    <i class="fas fa-chevron-@(tarefasMenuExpanded ? "down" : "right") menu-arrow"></i>
                </div>
            </div>
            
            <!-- Submenu de Tarefas -->
            <div class="submenu @(tarefasMenuExpanded ? "show" : "")">
                <NavLink class="nav-link submenu-item" href="tarefas">
                    <i class="fas fa-list me-2"></i> Todas as Tarefas
                </NavLink>
                <NavLink class="nav-link submenu-item" href="tarefas/nova">
                    <i class="fas fa-plus me-2"></i> Nova Tarefa
                </NavLink>
                <NavLink class="nav-link submenu-item" href="tarefas/vencidas">
                    <i class="fas fa-exclamation-triangle me-2 text-warning"></i> Vencidas
                </NavLink>
                <NavLink class="nav-link submenu-item" href="tarefas/concluidas">
                    <i class="fas fa-check-circle me-2 text-success"></i> Concluídas
                </NavLink>
                <NavLink class="nav-link submenu-item" href="tarefas/em-andamento">
                    <i class="fas fa-clock me-2 text-info"></i> Em Andamento
                </NavLink>
                <NavLink class="nav-link submenu-item" href="tarefas/pendentes">
                    <i class="fas fa-pause-circle me-2 text-secondary"></i> Pendentes
                </NavLink>
            </div>
        </div>
        
        <!-- Pessoas (Menu Expansível) -->
        <div class="nav-item px-3">
            <div class="nav-link menu-expandable @(pessoasMenuExpanded ? "expanded" : "")" @onclick="TogglePessoasMenu" @onclick:stopPropagation="true">
                <div style="color: aliceblue"  class="d-flex justify-content-between align-items-center">
                    <span>
                        <i class="fas fa-user-friends me-2"></i> Gestão de Pessoas
                    </span>
                    <i class="fas fa-chevron-@(pessoasMenuExpanded ? "down" : "right") menu-arrow"></i>
                </div>
            </div>
            
            <!-- Submenu de Pessoas -->
            <div class="submenu @(pessoasMenuExpanded ? "show" : "")">
                <NavLink class="nav-link submenu-item" href="pessoas">
                    <i class="fas fa-list me-2"></i> Todas as Pessoas
                </NavLink>
                <NavLink class="nav-link submenu-item" href="pessoas/nova">
                    <i class="fas fa-user-plus me-2"></i> Nova Pessoa
                </NavLink>
                <NavLink class="nav-link submenu-item" href="pessoas/buscar">
                    <i class="fas fa-search me-2"></i> Buscar Pessoa
                </NavLink>
            </div>
        </div>
    </nav>
</div>

@code {
    private bool collapseNavMenu = true;
    private bool tarefasMenuExpanded = false;
    private bool pessoasMenuExpanded = false;

    private string? NavMenuCssClass => collapseNavMenu ? "collapse" : null;

    private void ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
    }

    private void CollapseNavMenu()
    {
        collapseNavMenu = true;
    }

    private void ToggleTarefasMenu()
    {
        tarefasMenuExpanded = !tarefasMenuExpanded;
        // Colapsar outros menus
        if (tarefasMenuExpanded)
        {
            pessoasMenuExpanded = false;
        }
    }

    private void TogglePessoasMenu()
    {
        pessoasMenuExpanded = !pessoasMenuExpanded;
        // Colapsar outros menus
        if (pessoasMenuExpanded)
        {
            tarefasMenuExpanded = false;
        }
    }
}